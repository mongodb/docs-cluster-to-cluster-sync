.. _c2c-release-notes-1.4:

===================================
Release Notes for ``mongosync`` 1.4
===================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

**Version 1.4 released June 16, 2023**

New Features
-------------

Set Cluster Workload Level
~~~~~~~~~~~~~~~~~~~~~~~~~~

Starting in 1.4.0, you can set the workload level that
{+c2c-product-name+} uses to sync data between the source and
destination clusters. For more information, see the
:option:`--loadLevel` option.

Improved Resiliency for ``oplog`` Rollover 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

``mongosync`` 1.4.0 improves :term:`oplog` handling. The ``oplog``
handling improvement adds resiliency to long running operations.

``mongosync`` does an initial data copy and then applies updates from
the ``oplog`` to sync the source and destination clusters. In earlier
versions, ``mongosync`` waits to complete the initial sync before it
begins to replicate any changes from the ``oplog``. If there is a large
initial data set, the ``oplog`` can roll over before ``mongosync`` can
complete the initial data transfer. When this happens, the sync has to
be restarted from the beginning.

Starting in 1.4.0, ``mongosync`` begins to apply changes while the
initial sync is still in progress. Since ``mongosync`` starts to apply
changes earlier, ``mongosync`` maintains a recent position in the
``oplog``. This mitigates the risk of ``oplog`` roll over and
significantly lowers the risk of restarting the sync.

For more information, see :ref:`oplog sizing <c2c-oplog-sizing>`.

Faster Processing
~~~~~~~~~~~~~~~~~

Version 1.4.0 improves ``change event application`` speeds for improved
performance.

Improved Memory Handling
~~~~~~~~~~~~~~~~~~~~~~~~

In version 1.4.0, ``mongosync`` uses less memory to buffer change
events. Improved memory handling alleviates some out-of-memory (OOM)
issues.

Telemetry
~~~~~~~~~

Starting in 1.4.0, ``mongosync`` collects anonymous, aggregated usage
data to improve MongoDB products. You can disable collection of this
:ref:`telemetry <c2c-telemetry>` data when you start ``mongosync``.

Bug Fixes
----------

- Fixes an issue so documents with ``_id`` values that evaluate to the
  same string replicate correctly.

- Fixes a collection naming issue. Prior to version 1.4.0, ``mongosync``
  crashes when a new collection reuses a dropped collection's name with
  letter case changes.
  
  For example, previous versions of ``mongosync`` crash if a new
  ``SampleName`` collection replaces the dropped ``samplename``
  collection.

Additional Considerations
-------------------------

The MongoDB server's :dbcommand:`validate` command may report data
corruption on destination clusters that run MongoDB version 6.0 through
6.0.6. The data on the destination server is not corrupt. A bug in the
:ref:`WiredTiger <storage-wiredtiger>` database engine,
:issue:`WT-11051`, causes the false report.

Minimum Supported Version
-------------------------

In 1.4.0, the minimum supported version of MongoDB is 6.0.5.

